{
  "permissions": {
    "allow": [
      "Bash(start:*)",
      "Bash(tree \"D:\\Projects\\Emuera\\Emuera\" /F:*)",
      "Bash(cat \"/d/Projects/Emuera/Emuera.sln\":*)",
      "Bash(cat:*)",
      "Bash(git init:*)",
      "Bash(swift build -v)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git rm:*)",
      "Bash(git remote add:*)",
      "Bash(git branch:*)",
      "Bash(swift build:*)",
      "Bash(find:*)",
      "Bash(swift package:*)",
      "Bash(swift test --list-tests)",
      "Bash(.build/debug/emuera:*)",
      "Bash(xxd:*)",
      "Bash(perl -i -pe:*)",
      "Bash(printf '%s' '//\n//  LexicalAnalyzer.swift\n//  EmueraCore\n//  MVP版词法分析器\n//  Created: 2025-12-18\n//\n\nimport Foundation\n\npublic struct LexicalAnalyzer {\n    public func tokenize(_ source: String) -> [TokenType.Token] {\n        var tokens: [TokenType.Token] = []\n        var index = source.startIndex\n        var line = 1\n\n        while index < source.endIndex {\n            let c = source[index]\n\n            // 空白处理\n            if c.isWhitespace {\n                if c == \"\"\\n\"\" {\n                    line += 1\n                    tokens.append(TokenType.Token(type: .lineBreak, value: \"\"\\n\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                }\n                source.formIndex(after: &index)\n                continue\n            }\n\n            // 注释\n            if c == \"\";\"\" {\n                while index < source.endIndex && source[index] != \"\"\\n\"\" {\n                    source.formIndex(after: &index)\n                }\n                continue\n            }\n\n            // 字符串\n            if c == \"\"\\\"\"\"\" {\n                let start = source.index(after: index)\n                var current = start\n                while current < source.endIndex && source[current] != \"\"\\\"\"\"\" {\n                    source.formIndex(after: ¤t)\n                }\n                if current < source.endIndex {\n                    let value = String(source[start..<current])\n                    let token = TokenType.Token(type: .string(value), value: value, position: ScriptPosition(filename: \"\"script\"\", lineNumber: line))\n                    tokens.append(token)\n                    index = source.index(after: current)\n                    continue\n                }\n            }\n\n            // 数字\n            if c.isNumber {\n                var current = index\n                var digits = \"\"\"\"\n                while current < source.endIndex && source[current].isNumber {\n                    digits.append(source[current])\n                    source.formIndex(after: ¤t)\n                }\n                if let value = Int64(digits) {\n                    tokens.append(TokenType.Token(type: .integer(value), value: digits, position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                }\n                index = current\n                continue\n            }\n\n            // 标识符\n            if c.isLetter || c == \"\"$\"\" || c == \"\"%\"\" || c == \"\"@\"\" {\n                var current = index\n                var identifier = \"\"\"\"\n                while current < source.endIndex {\n                    let ch = source[current]\n                    if ch.isLetter || ch.isNumber || ch == \"\"_\"\" || ch == \"\"$\"\" || ch == \"\"%\"\" || ch == \"\":\"\" {\n                        identifier.append(ch)\n                        source.formIndex(after: ¤t)\n                    } else {\n                        break\n                    }\n                }\n\n                let tokenType: TokenType\n                let upper = identifier.uppercased()\n                if [\"\"PRINT\"\", \"\"PRINTL\"\", \"\"PRINTW\"\", \"\"INPUT\"\", \"\"WAIT\"\", \"\"QUIT\"\"].contains(upper) {\n                    tokenType = .command(identifier)\n                } else if identifier.hasPrefix(\"\"$\"\") || identifier.hasPrefix(\"\"%\"\") {\n                    tokenType = .variable(identifier)\n                } else if identifier.hasPrefix(\"\"@\"\") {\n                    tokenType = .label(identifier)\n                } else if [\"\"ABS\"\", \"\"SQRT\"\", \"\"SIN\"\"].contains(upper) {\n                    tokenType = .function(identifier)\n                } else if [\"\"IF\"\", \"\"ELSE\"\", \"\"FOR\"\"].contains(upper) {\n                    tokenType = .keyword(identifier)\n                } else {\n                    tokenType = .string(identifier)\n                }\n\n                tokens.append(TokenType.Token(type: tokenType, value: identifier, position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                index = current\n                continue\n            }\n\n            // 操作符\n            let nextIndex = source.index(after: index)\n            let twoChar = nextIndex < source.endIndex ? String([c, source[nextIndex]]) : \"\"\"\"\n\n            if twoChar != \"\"\"\" {\n                if let op = TokenType.Operator(rawValue: twoChar) {\n                    tokens.append(TokenType.Token(type: .operatorSymbol(op), value: twoChar, position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                    index = nextIndex\n                    source.formIndex(after: &index)\n                    continue\n                }\n\n                if let comp = TokenType.Comparator(rawValue: twoChar) {\n                    tokens.append(TokenType.Token(type: .comparator(comp), value: twoChar, position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                    index = nextIndex\n                    source.formIndex(after: &index)\n                    continue\n                }\n            }\n\n            if let op = TokenType.Operator(rawValue: String(c)) {\n                tokens.append(TokenType.Token(type: .operatorSymbol(op), value: String(c), position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                source.formIndex(after: &index)\n                continue\n            }\n            if let comp = TokenType.Comparator(rawValue: String(c)) {\n                tokens.append(TokenType.Token(type: .comparator(comp), value: String(c), position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n                source.formIndex(after: &index)\n                continue\n            }\n\n            // 标点\n            switch c {\n            case \"\",\"\":\n                tokens.append(TokenType.Token(type: .comma, value: \"\",\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            case \"\":\"\":\n                tokens.append(TokenType.Token(type: .colon, value: \"\":\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            case \"\"(\"\":\n                tokens.append(TokenType.Token(type: .parenthesisOpen, value: \"\"(\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            case \"\")\"\":\n                tokens.append(TokenType.Token(type: .parenthesisClose, value: \"\")\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            case \"\"[\"\":\n                tokens.append(TokenType.Token(type: .bracketOpen, value: \"\"[\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            case \"\"]\"\":\n                tokens.append(TokenType.Token(type: .bracketClose, value: \"\"]\"\", position: ScriptPosition(filename: \"\"script\"\", lineNumber: line)))\n            default:\n                break\n            }\n            source.formIndex(after: &index)\n        }\n\n        return tokens\n    }\n}\n')",
      "Bash(nano:*)",
      "Bash(pkill:*)",
      "Bash(clear:*)",
      "Bash(python3:*)",
      "Bash(swift test:*)"
    ]
  }
}
